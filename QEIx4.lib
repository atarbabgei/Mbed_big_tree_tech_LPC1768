http://os.mbed.com/teams/OpenMoCo/code/QEIx4/#c0b87b11b9cd2e2069c7ecdafc7ca469c8f9e5cc